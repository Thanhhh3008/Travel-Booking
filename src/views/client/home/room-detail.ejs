<%- include('../layout/header.ejs') %>
  <link rel="stylesheet" href="/style-roomdetail.css">
  <main class="container section page-room-detail">
    <!-- Th√¥ng b√°o flash -->
    <% if (message) { %>
      <div class="alert <%= message.type %>">
        <span class="alert-icon">
          <%= message.type==='success' ? '‚úÖ' : '‚ö†Ô∏è' %>
        </span>
        <span class="alert-text">
          <%= message.mess %>
        </span>
        <button class="alert-close" onclick="this.parentElement.style.display='none';">&times;</button>
      </div>
      <% } %>

        <!-- Room Header -->
        <div class="room-header">
          <div>
            <h1>Ph√≤ng <%= room.TenChoO || 'Ch∆∞a r√µ' %>
                <%= room.TenLoaiPhong || 'Ch∆∞a r√µ' %>
                  <%= room.SoPhong ? '- Ph√≤ng ' + room.SoPhong : '' %>
            </h1>
            <div class="room-subtitle">
              <% if (room.Rating) { %>
                <span class="rating">‚≠ê <%= room.Rating %></span>
                <span class="divider">¬∑</span>
                <% } %>
                  <span>
                    <%= room.View || 'Ch∆∞a r√µ' %>
                  </span>
                  <span class="divider">¬∑</span>
                  <span>
                    <%= room.ThanhPho || 'Ch∆∞a r√µ' %>
                  </span>
            </div>
          </div>
          <div class="room-header-actions">
            <a href="">
              <i class="fa-solid fa-arrow-up-right-from-square"></i> Chia s·∫ª
            </a>

            <a href="">
              <i class="fa-regular fa-heart"></i> L∆∞u
            </a>
          </div>

        </div>

        <!-- Room Gallery -->
        <div class="room-gallery">
          <% const images=room.HinhAnh ? room.HinhAnh.split(',') : []; const displayImages=images.slice(0, 5); %>

            <% if (displayImages.length> 0) { %>
              <img src="/admin/uploads/anhphong/<%= displayImages[0].trim() %>" alt="<%= room.TenLoaiPhong %>"
                class="gallery-main">

              <% for(let i=1; i < displayImages.length && i < 5; i++) { %>
                <img src="/admin/uploads/anhphong/<%= displayImages[i].trim() %>" alt="<%= room.TenLoaiPhong %>">
                <% } %>
                  <% } else { %>
                    <img src="/admin/uploads/anhphong/default.jpg" alt="Ph√≤ng" class="gallery-main">
                    <% } %>

                      <% if (images.length> 5) { %>
                        <button class="show-all-photos" onclick="alert('M·ªü th∆∞ vi·ªán ·∫£nh ƒë·∫ßy ƒë·ªß')">
                          <span>‚äû</span> Hi·ªÉn th·ªã t·∫•t c·∫£ ·∫£nh
                        </button>
                        <% } %>
        </div>

        <!-- Room Content -->
        <div class="room-content">
          <!-- Left side - Room info -->
          <div class="room-info-section">
            <!-- Title Section -->
            <div class="room-title-section">
              <h2>To√†n b·ªô nh√† ngh·ªâ <%= room.TenChoO || 'Ch∆∞a r√µ' %> t·∫°i <%= room.DiaChi ? room.DiaChi.split(',')[0]
                    : 'Li√™n S∆°n' %>, Vi·ªát Nam</h2>
              <div class="room-meta-inline">
                <span>3 kh√°ch</span>
                <span>1 ph√≤ng ng·ªß</span>
                <span>1 gi∆∞·ªùng</span>
                <span>1 ph√≤ng t·∫Øm</span>
              </div>
            </div>

            <!-- Host Section -->
            <div class="host-section">
              <img src="/admin/uploads/avatar/default-host.jpg" alt="Host" class="host-avatar"
                onerror="this.style.display='none'">
              <div class="host-info">
                <h3>Host: <%= room.Username || 'Ch∆∞a r√µ' %>
                </h3>
                <p class="host-meta">11 nƒÉm l√†m host tr√™n TripStay</p>
              </div>
            </div>

            <!-- Description -->
            <% if (room.MoTa || room.description) { %>
              <div class="room-desc-block">
                <p>
                  <%= room.MoTa || room.description %>
                </p>
                <button class="show-more-btn" onclick="alert('Hi·ªÉn th·ªã th√™m m√¥ t·∫£')">Hi·ªÉn th·ªã th√™m ></button>
              </div>
              <% } %>

                <!-- Amenities -->
                <!-- Amenities -->
                <div class="amenities-section">
                  <h3>N∆°i n√†y c√≥ nh·ªØng g√¨ cho b·∫°n</h3>

                  <div class="amenities-grid">

                    <div class="amenity-item">
                      <i class="fa-solid fa-kitchen-set amenity-icon"></i>
                      <span class="amenity-text">B·∫øp</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-wifi amenity-icon"></i>
                      <span class="amenity-text">Wi-fi</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-briefcase amenity-icon"></i>
                      <span class="amenity-text">Kh√¥ng gian ri√™ng ƒë·ªÉ l√†m vi·ªác</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-car amenity-icon"></i>
                      <span class="amenity-text">Ch·ªó ƒë·ªó xe mi·ªÖn ph√≠ t·∫°i n∆°i ·ªü</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-person-swimming amenity-icon"></i>
                      <span class="amenity-text">B·ªÉ b∆°i</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-hot-tub-person amenity-icon"></i>
                      <span class="amenity-text">B·ªìn t·∫Øm n∆∞·ªõc n√≥ng</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-dog amenity-icon"></i>
                      <span class="amenity-text">Cho ph√©p th√∫ c∆∞ng</span>
                    </div>

                    <div class="amenity-item">
                      <i class="fa-solid fa-video amenity-icon"></i>
                      <span class="amenity-text">Camera an ninh ngo√†i nh√†</span>
                    </div>

                    <div class="amenity-item amenity-unavailable">
                      <i class="fa-solid fa-ban amenity-icon"></i>
                      <span class="amenity-text">M√°y ph√°t hi·ªán kh√≠ CO</span>
                    </div>

                    <div class="amenity-item amenity-unavailable">
                      <i class="fa-solid fa-ban amenity-icon"></i>
                      <span class="amenity-text">Cho ph√©p thu·ªëc l√°</span>
                    </div>

                  </div>
                </div>


                <!-- Reviews -->
                <div class="reviews-section">
                  <!-- <div class="reviews-header">
                    <h3>‚≠ê <%= room.Rating || '5.0' %>
                    </h3>
                    <span>¬∑ 2 ƒë√°nh gi√°</span>
                  </div> -->

                  <!-- Review Form -->
                  <div class="room-desc-block">
                    <h3>Vi·∫øt ƒë√°nh gi√° c·ªßa b·∫°n</h3>

                    <form action="/rooms/review" method="POST" class="review-form">

                      <!-- Hidden: ID ph√≤ng -->
                      <input type="hidden" name="roomId" value="<%= room.MaPhong || room.id %>">
                      <input type="hidden">
                      <!-- Rating -->
                      <div class="form-group">
                        <label>ƒê√°nh gi√° c·ªßa b·∫°n</label>
                        <div class="star-rating">
                          <% for(let i=5; i>= 1; i--) { %>
                            <input type="radio" id="star-<%= i %>" name="rate" value="<%= i %>" required>
                            <label for="star-<%= i %>">‚òÖ</label>
                            <% } %>
                        </div>
                      </div>

                      <!-- Email -->
                      <!-- <div class="form-group">
                        <label>Email</label>
                        <input type="email" name="email" placeholder="email@example.com" required>
                      </div> -->

                      <!-- Content -->
                      <div class="form-group">
                        <label>N·ªôi dung ƒë√°nh gi√°</label>
                        <textarea name="content" rows="4" placeholder="H√£y chia s·∫ª tr·∫£i nghi·ªám c·ªßa b·∫°n..."
                          required></textarea>
                      </div>

                      <button type="submit" class="btn primary">
                        G·ª≠i ƒë√°nh gi√°
                      </button>
                    </form>
                  </div>

                  <div class="reviews-grid">
                    <div class="review-item">
                      <div class="review-header">
                        <div class="reviewer-avatar">D</div>
                        <div class="reviewer-info">
                          <h4>Delphine</h4>
                          <p class="reviewer-meta">11 nƒÉm ho·∫°t ƒë·ªông tr√™n TripStay</p>
                        </div>
                      </div>
                      <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                      <p class="reviewer-meta">2 ng√†y tr∆∞·ªõc</p>
                      <p class="review-text">Tr√®s bon accueil, m√™me si on a vraiment eu du mal √† trouver et une personne
                        nous a guid√© avec son scooter. Nous √©tions √† v√©lo. Il y a une belle c√¥te √† la fin. Sans r√©seau,
                        j'ai r√©serv√© en...</p>
                      <button class="show-more-btn" onclick="alert('Hi·ªÉn th·ªã th√™m ƒë√°nh gi√°')">Hi·ªÉn th·ªã th√™m</button>
                    </div>

                    <div class="review-item">
                      <div class="review-header">
                        <div class="reviewer-avatar">–ì</div>
                        <div class="reviewer-info">
                          <h4>–ì–µ–æ—Ä–≥–∏–π</h4>
                          <p class="reviewer-meta">7 nƒÉm ho·∫°t ƒë·ªông tr√™n TripStay</p>
                        </div>
                      </div>
                      <div class="review-rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                      <p class="reviewer-meta">1 tu·∫ßn tr∆∞·ªõc</p>
                      <p class="review-text">amazing place, very beautiful surroundings, definitely will come back</p>
                      <button class="show-more-btn" onclick="alert('Hi·ªÉn th·ªã th√™m ƒë√°nh gi√°')">Hi·ªÉn th·ªã th√™m</button>
                    </div>
                  </div>

                  <button class="show-more-btn" style="margin-top: 24px;">Quy tr√¨nh ƒë√°nh gi√°</button>
                </div>

                <!-- Host Profile -->
                <div class="room-desc-block">
                  <h3>G·∫∑p g·ª° host c·ªßa b·∫°n</h3>
                  <div class="host-section">
                    <img src="/admin/uploads/avatar/default-host.jpg" alt="Host" class="host-avatar"
                      onerror="this.style.display='none'">
                    <div class="host-info">
                      <h3>
                        <%= room.HoTen || 'Ch∆∞a r√µ' %>
                      </h3>
                      <p class="host-meta">Host</p>
                      <div style="margin-top: 12px;">
                        <p><strong>11</strong> ƒê√°nh gi√°</p>
                        <p><strong>4,82‚òÖ</strong> X·∫øp h·∫°ng</p>
                        <p><strong>1</strong> Th√°ng kinh nghi·ªám ƒë√≥n ti·∫øp kh√°ch</p>
                      </div>
                    </div>
                  </div>
                  <p style="margin-top: 16px; line-height: 1.6;">
                    üìç Sinh ra v√†o th·∫≠p ni√™n 80<br>
                    üíº C√¥ng vi·ªác c·ªßa t√¥i: The Moon Villa
                  </p>
                  <p style="margin-top: 16px; line-height: 1.6;">
                    Xin ch√†o, m√¨nh l√† <%= room.HoTen || 'Ch∆∞a r√µ' %> ‚Äì m·ªôt ng∆∞·ªùi y√™u thi√™n nhi√™n, y√™u bi·ªÉn v√† ƒë·∫∑c bi·ªát
                      ƒëam m√™ nh·ªØng ng√¥i nh√† ƒë·∫πp mang h∆°i th·ªü b√¨nh y√™n...
                  </p>
                  <button class="show-more-btn">Nh·∫Øn tin cho host</button>
                </div>

                <!-- Additional Info -->
                <div class="room-desc-block">
                  <h3>Th√¥ng tin Ch·ªß nh√†</h3>
                  <p><strong>T·ªâ l·ªá ph·∫£n h·ªìi:</strong> 100%</p>
                  <p><strong>Ph·∫£n h·ªìi trong v√≤ng:</strong> 1 gi·ªù</p>
                  <button class="show-more-btn" style="margin-top: 16px;">Nh·∫Øn tin cho host</button>
                  <p style="font-size: 12px; color: #717171; margin-top: 24px;">
                    üõ°Ô∏è ƒê·ªÉ b·∫£o v·ªá kho·∫£n thanh to√°n c·ªßa b·∫°n, h√£y lu√¥n s·ª≠ d·ª•ng TripStay ƒë·ªÉ chuy·ªÉn ti·ªÅn v√† li√™n l·∫°c v·ªõi
                    host.
                  </p>
                </div>
          </div>

          <!-- Right side - Booking card -->
          <div class="booking-card">
            <div class="booking-price">
              <span class="price">
                <%= helpers.formatMoney(room.Gia || room.price) %>
              </span>
              <span class="per-night">/ƒë√™m</span>
            </div>


            <!-- N√∫t ƒë·∫∑t ph√≤ng -->
            <div class="room-actions">
              <a href="/rooms/<%= room.MaPhong || room.id %>/book" class="btn primary">
                ƒê·∫∑t ph√≤ng ngay
              </a>
              <a href="/" class="btn">Quay l·∫°i trang ch·ªß</a>
            </div>
          </div>
        </div>
  </main>

  <%- include('../layout/footer.ejs') %>