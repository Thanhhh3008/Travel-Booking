<%- include('./layout/header') %>

<div class="container mt-5">
  <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
    <div class="card-body bg-light p-4">

      <h3 class="card-title text-primary fw-bold mb-4">Chi ti·∫øt ch·ªó ·ªü: <%= room.SoPhong %></h3>
      <hr>

    <div class="row mb-4">
  <div class="col-md-6">
    <p>
      <strong>
        <i class="fa-solid fa-location-dot me-1"></i> ƒê·ªãa ch·ªâ:
      </strong>
      <%= room.DiaChi %>
    </p>

    <p>
      <strong>
        <i class="fa-solid fa-city me-1"></i> Th√†nh ph·ªë:
      </strong>
      <%= room.ThanhPho %>
    </p>

    <p>
      <strong>
        <i class="fa-solid fa-bed me-1"></i> Lo·∫°i ph√≤ng:
      </strong>
      <%= room.TenLoaiPhong %>
    </p>

    <p>
      <strong>
        <i class="fa-solid fa-ruler-combined me-1"></i> Di·ªán t√≠ch:
      </strong>
      <%= room.DienTich %> m¬≤
    </p>
  </div>

  <div class="col-md-6">
    <p>
      <strong>
        <i class="fa-solid fa-star me-1"></i> Rating:
      </strong>
      <span class="badge bg-warning text-dark">
        <%= room.Rating %>
      </span>
    </p>

    <p>
      <strong>
        <i class="fa-solid fa-signal me-1"></i> Tr·∫°ng th√°i:
      </strong>
      <span class="badge <%= room.TrangThaiPhong === 'Ch·ªù x√©t duy·ªát' ? 'bg-secondary' : 'bg-success' %>">
        <%= room.TrangThaiPhong %>
      </span>
    </p>

    <p>
      <strong>
        <i class="fa-solid fa-users me-1"></i> S·ªë kh√°ch t·ªëi ƒëa:
      </strong>
      <%= room.SoKhachToiDa %>
    </p>

    <p>
      <strong>
        <i class="fa-solid fa-money-bill-wave me-1"></i> Gi√°:
      </strong>
      <%= room.Gia.toLocaleString() %> VND
    </p>
  </div>
</div>


      <% if (room.HinhAnh || room.GiayToPhong) { %>

        <!-- ·∫¢nh ph√≤ng -->
        <% if (room.HinhAnh) { %>
        <div class="mb-5">
          <h5 class="fw-bold mb-3 text-dark">üñºÔ∏è ·∫¢nh ph√≤ng</h5>
          <div class="gallery-grid mb-4">
            <% room.HinhAnh.split(',').forEach((img) => { %>
              <a href="/admin/uploads/anhphong/<%= img.trim() %>" class="glightbox" data-gallery="anhphong">
                <img src="/admin/uploads/anhphong/<%= img.trim() %>" class="gallery-img" alt="H√¨nh ·∫£nh ph√≤ng">
              </a>
            <% }) %>
          </div>
        </div>
        <% } %>

        <!-- ·∫¢nh gi·∫•y t·ªù ph√°p l√Ω -->
        <% if (room.GiayToPhong) { %>
        <div class="mb-3">
          <h5 class="fw-bold mb-3 text-dark">üìÑ ·∫¢nh gi·∫•y t·ªù ph√°p l√Ω</h5>
          <div class="gallery-grid mb-4">
            <% room.GiayToPhong.split(',').forEach((img) => { %>
              <a href="/admin/uploads/anhphaply/<%= img.trim() %>" class="glightbox" data-gallery="giayto">
                <img src="/admin/uploads/anhphaply/<%= img.trim() %>" class="gallery-img" alt="Gi·∫•y t·ªù ph√°p l√Ω">
              </a>
            <% }) %>
          </div>
        </div>
        <% } %>

      <% } %>

  <div class="d-flex justify-content-end mt-4 gap-3">
  <% if (room.TrangThaiPhong === 'Ch·ªù x√©t duy·ªát') { %>
    <!-- N√∫t ph√™ duy·ªát / t·ª´ ch·ªëi -->
    <form action="/admin/duyetphong/<%= room.MaPhong %>/approve" method="POST">
      <button type="submit" class="btn btn-success btn-lg px-4 shadow-sm">‚úÖ Ph√™ duy·ªát</button>
    </form>

    <button type="button" class="btn btn-danger btn-lg px-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#rejectModal">
      ‚ùå T·ª´ ch·ªëi
    </button>
  <% } else if (room.TrangThaiPhong === 'ƒê√£ duy·ªát') { %>
    <!-- N·∫øu ph√≤ng ƒë√£ duy·ªát th√¨ hi·ªán n√∫t ·∫®n kh·ªèi web -->
    <form action="/admin/duyetphong/<%= room.MaPhong %>/hide" method="POST">
      <button type="submit" class="btn btn-warning btn-lg px-4 shadow-sm">üôà ·∫®n kh·ªèi web</button>
    </form>
  <% } else if (room.TrangThaiPhong === '·∫®n') { %>
    <!-- N·∫øu ph√≤ng ƒëang b·ªã ·∫©n th√¨ hi·ªán n√∫t Hi·ªÉn th·ªã l·∫°i -->
    <form action="/admin/duyetphong/<%= room.MaPhong %>/show" method="POST">
      <button type="submit" class="btn btn-info btn-lg px-4 shadow-sm text-white">üëÅÔ∏è Hi·ªÉn th·ªã l·∫°i</button>
    </form>
  <% } %>

  <a href="/admin/duyetphong/tatca" class="btn btn-outline-secondary btn-lg px-4 shadow-sm">Quay l·∫°i</a>
</div>



    </div>
  </div>
</div>

<!-- Modal nh·∫≠p l√Ω do -->
<div class="modal fade" id="rejectModal" tabindex="-1" aria-labelledby="rejectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <form action="/admin/duyetphong/<%= room.MaPhong %>/reject" method="POST" class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">T·ª´ ch·ªëi ph√™ duy·ªát ph√≤ng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
      </div>
      <div class="modal-body">
        <label for="reason" class="form-label fw-bold">L√Ω do t·ª´ ch·ªëi:</label>
        <textarea name="reason" id="reason" class="form-control" rows="4" required placeholder="Nh·∫≠p l√Ω do t·ª´ ch·ªëi..."></textarea>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-danger">X√°c nh·∫≠n t·ª´ ch·ªëi</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
      </div>
    </form>
  </div>
</div>
<!-- GLightbox (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>
<script>
  GLightbox({ selector: '.glightbox', touchNavigation: true, loop: true });
</script>
<script>
  const form = document.querySelector('#rejectModal form');
  const reasonInput = document.getElementById('reason');

  form.addEventListener('submit', function(e) {
    if (reasonInput.value.length > 200) {
      e.preventDefault(); 
      alert('L√Ω do t·ª´ ch·ªëi kh√¥ng ƒë∆∞·ª£c qu√° 200 k√Ω t·ª±!');
    }
  });
</script>
<style>
  body {
    background: linear-gradient(to bottom right, #eef2f3, #ffffff);
    min-height: 100vh;
  }

  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
    gap: 12px;
  }

  .gallery-img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 10px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
  }

  .gallery-img:hover {
    transform: scale(1.03);
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  }

  .card {
    transition: all 0.3s ease;
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  }

  h5 {
    border-left: 4px solid #0d6efd;
    padding-left: 10px;
  }
  body.modal-open .card:hover {
  transform: none !important;
  box-shadow: none !important;
}

</style>

<%- include('./layout/footer') %>
