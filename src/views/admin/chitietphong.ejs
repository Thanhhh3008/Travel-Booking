<%- include('./layout/header') %>

<div class="container mt-5">
  <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
    <div class="card-body bg-light p-4">

      <h3 class="card-title text-primary fw-bold mb-4">ğŸ  Chi tiáº¿t chá»— á»Ÿ: <%= room.SoPhong %></h3>
      <hr>

      <div class="row mb-4">
        <div class="col-md-6">
          <p><strong>ğŸ“ Äá»‹a chá»‰:</strong> <%= room.DiaChi %></p>
          <p><strong>ğŸ“ MÃ´ táº£:</strong> <%= room.MoTa %></p>
          <p><strong>ğŸ›ï¸ Loáº¡i phÃ²ng:</strong> <%= room.TenLoaiPhong %></p>
          <p><strong>ğŸ“ Diá»‡n tÃ­ch:</strong> <%= room.DienTich %> mÂ²</p>
          

        </div>
        <div class="col-md-6">
          <p><strong>â­ Rating:</strong> <span class="badge bg-warning text-dark"><%= room.Rating %></span></p>
          <p><strong>ğŸ“Š Tráº¡ng thÃ¡i:</strong> 
            <span class="badge <%= room.TrangThaiPhong === 'Chá» xÃ©t duyá»‡t' ? 'bg-secondary' : 'bg-success' %>">
              <%= room.TrangThaiPhong %>
            </span>
          </p>
          <p><strong>ğŸ‘¥ Sá»‘ khÃ¡ch tá»‘i Ä‘a:</strong> <%= room.SoKhachToiDa %></p>
          <p><strong>ğŸ’° GiÃ¡:</strong> <%= room.Gia.toLocaleString() %> VND</p>
        </div>
      </div>

      <% if (room.HinhAnh || room.GiayToPhong) { %>

        <!-- áº¢nh phÃ²ng -->
        <% if (room.HinhAnh) { %>
        <div class="mb-5">
          <h5 class="fw-bold mb-3 text-dark">ğŸ–¼ï¸ áº¢nh phÃ²ng</h5>
          <div class="gallery-grid mb-4">
            <% room.HinhAnh.split(',').forEach((img) => { %>
              <a href="/admin/uploads/anhphong/<%= img.trim() %>" class="glightbox" data-gallery="anhphong">
                <img src="/admin/uploads/anhphong/<%= img.trim() %>" class="gallery-img" alt="HÃ¬nh áº£nh phÃ²ng">
              </a>
            <% }) %>
          </div>
        </div>
        <% } %>

        <!-- áº¢nh giáº¥y tá» phÃ¡p lÃ½ -->
        <% if (room.GiayToPhong) { %>
        <div class="mb-3">
          <h5 class="fw-bold mb-3 text-dark">ğŸ“„ áº¢nh giáº¥y tá» phÃ¡p lÃ½</h5>
          <div class="gallery-grid mb-4">
            <% room.GiayToPhong.split(',').forEach((img) => { %>
              <a href="/admin/uploads/anhphaply/<%= img.trim() %>" class="glightbox" data-gallery="giayto">
                <img src="/admin/uploads/anhphaply/<%= img.trim() %>" class="gallery-img" alt="Giáº¥y tá» phÃ¡p lÃ½">
              </a>
            <% }) %>
          </div>
        </div>
        <% } %>

      <% } %>

  <div class="d-flex justify-content-end mt-4 gap-3">
  <% if (room.TrangThaiPhong === 'Chá» xÃ©t duyá»‡t') { %>
    <!-- NÃºt phÃª duyá»‡t / tá»« chá»‘i -->
    <form action="/admin/duyetphong/<%= room.MaPhong %>/approve" method="POST">
      <button type="submit" class="btn btn-success btn-lg px-4 shadow-sm">âœ… PhÃª duyá»‡t</button>
    </form>

    <button type="button" class="btn btn-danger btn-lg px-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#rejectModal">
      âŒ Tá»« chá»‘i
    </button>
  <% } else if (room.TrangThaiPhong === 'ÄÃ£ duyá»‡t') { %>
    <!-- Náº¿u phÃ²ng Ä‘Ã£ duyá»‡t thÃ¬ hiá»‡n nÃºt áº¨n khá»i web -->
    <form action="/admin/duyetphong/<%= room.MaPhong %>/hide" method="POST">
      <button type="submit" class="btn btn-warning btn-lg px-4 shadow-sm">ğŸ™ˆ áº¨n khá»i web</button>
    </form>
  <% } else if (room.TrangThaiPhong === 'áº¨n') { %>
    <!-- Náº¿u phÃ²ng Ä‘ang bá»‹ áº©n thÃ¬ hiá»‡n nÃºt Hiá»ƒn thá»‹ láº¡i -->
    <form action="/admin/duyetphong/<%= room.MaPhong %>/show" method="POST">
      <button type="submit" class="btn btn-info btn-lg px-4 shadow-sm text-white">ğŸ‘ï¸ Hiá»ƒn thá»‹ láº¡i</button>
    </form>
  <% } %>

  <a href="/admin/duyetphong/tatca" class="btn btn-outline-secondary btn-lg px-4 shadow-sm">Quay láº¡i</a>
</div>



    </div>
  </div>
</div>

<!-- Modal nháº­p lÃ½ do -->
<div class="modal fade" id="rejectModal" tabindex="-1" aria-labelledby="rejectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <form action="/admin/duyetphong/<%= room.MaPhong %>/reject" method="POST" class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Tá»« chá»‘i phÃª duyá»‡t phÃ²ng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ÄÃ³ng"></button>
      </div>
      <div class="modal-body">
        <label for="reason" class="form-label fw-bold">LÃ½ do tá»« chá»‘i:</label>
        <textarea name="reason" id="reason" class="form-control" rows="4" required placeholder="Nháº­p lÃ½ do tá»« chá»‘i..."></textarea>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-danger">XÃ¡c nháº­n tá»« chá»‘i</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Há»§y</button>
      </div>
    </form>
  </div>
</div>
<!-- GLightbox (CDN) -->
<link href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js"></script>
<script>
  GLightbox({ selector: '.glightbox', touchNavigation: true, loop: true });
</script>
<script>
  const form = document.querySelector('#rejectModal form');
  const reasonInput = document.getElementById('reason');

  form.addEventListener('submit', function(e) {
    if (reasonInput.value.length > 200) {
      e.preventDefault(); 
      alert('LÃ½ do tá»« chá»‘i khÃ´ng Ä‘Æ°á»£c quÃ¡ 200 kÃ½ tá»±!');
    }
  });
</script>
<style>
  body {
    background: linear-gradient(to bottom right, #eef2f3, #ffffff);
    min-height: 100vh;
  }

  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
    gap: 12px;
  }

  .gallery-img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 10px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
  }

  .gallery-img:hover {
    transform: scale(1.03);
    box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  }

  .card {
    transition: all 0.3s ease;
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
  }

  h5 {
    border-left: 4px solid #0d6efd;
    padding-left: 10px;
  }
  body.modal-open .card:hover {
  transform: none !important;
  box-shadow: none !important;
}

</style>

<%- include('./layout/footer') %>
