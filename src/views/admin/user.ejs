<%- include('./layout/header') %>

<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center">
    <h3>üë• Qu·∫£n l√Ω Ng∆∞·ªùi d√πng</h3>

    <!--Thanh t√¨m ki·∫øm g√≥c ph·∫£i -->
    <form action="/admin/users" method="get" class="d-flex align-items-center gap-2 search-bar">
      <input 
        type="text" 
        name="search" 
        class="form-control form-control-sm search-input" 
        placeholder="Nh·∫≠p h·ªç t√™n, SƒêT ho·∫∑c email..." 
        value="<%= search || '' %>"
      >
      <button type="submit" class="btn btn-primary btn-sm">üîç</button>
      <% if (search) { %>
        <a href="/admin/users" class="btn btn-secondary btn-sm">‚ùå</a>
      <% } %>
    </form>
  </div>

  <!-- Danh s√°ch ng∆∞·ªùi d√πng -->
  <table class="table table-striped mt-4">
    <thead>
      <tr>
        <th>#</th>
        <th>Username</th>
        <th>H·ªç t√™n</th>
        <th>Email</th>
        <th>SƒêT</th>
        <th>Thao t√°c</th>
      </tr>
    </thead>
    <tbody>
      <% if (users && users.length > 0) { %>
        <% users.forEach((u, index) => { %>
          <tr>
            <td><%= u.MaNguoiDung %></td>
            <td><%= u.Username %></td>
            <td><%= u.HoTen %></td>
            <td><%= u.Email || '' %></td>
            <td><%= u.SDT || '' %></td>
            <td>
              <a href="/admin/user/detail/<%= u.MaNguoiDung %>" class="btn btn-info btn-sm">üëÅÔ∏è Xem chi ti·∫øt</a>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="6" class="text-center text-muted">Kh√¥ng c√≥ ng∆∞·ªùi d√πng n√†o.</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>

<style>
 
  .search-bar {
    max-width: 350px;
  }
  .search-input {
    width: 230px;
    height: 32px;
    font-size: 14px;
  }
  .btn-sm {
    padding: 4px 10px;
    font-size: 13px;
  }
</style>
<script>
  const params = new URLSearchParams(window.location.search);
  if (params.get('deleted') === '1') {
    alert('‚úÖ X√≥a ng∆∞·ªùi d√πng th√†nh c√¥ng! T·∫•t c·∫£ c√°c ph√≤ng v√† th√¥ng b√°o li√™n quan s·∫Ω b·ªã x√≥a!');
    // X√≥a query kh·ªèi URL ƒë·ªÉ kh√¥ng hi·ªán l·∫°i khi refresh
    window.history.replaceState({}, document.title, window.location.pathname);
  }
</script>

<%- include('./layout/footer') %>
